---
title: "OpneSAFELY demo"
author: "Will Hulme"
date: "14/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library('tidyverse')
library('jsonlite')


```

## Import measures

```{r, get_dict}
md_list <- jsonlite::fromJSON(here::here("lib","measures_dict.json"), simplifyVector = FALSE, flatten=FALSE)
md_tbl <- md_list %>%
  enframe(name="measure", value="dictionary") %>%
  unnest_wider(dictionary) %>% 
  unnest_longer(groups, values_to="list", indices_to="group") %>% rename(var_label=label) %>% 
  unnest_wider(list)  %>% 
  unnest_wider(measure_args)

measures <- md_tbl$id %>% map(~read_csv(here::here("output",glue::glue("measure_{.}.csv"))))

```

.csv